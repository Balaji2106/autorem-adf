# =============================================================================
# AIOps RCA Assistant - Environment Configuration
# =============================================================================
# Copy this file to .env and fill in your actual values
# cp .env.example .env

# -----------------------------------------------------------------------------
# Required: API Keys and Authentication
# -----------------------------------------------------------------------------
RCA_API_KEY=your-secret-api-key-here
JWT_SECRET_KEY=your-jwt-secret-key-for-auth

# AI Provider Configuration
# Choose your AI provider for RCA generation: gemini, ollama, or auto (fallback)
AI_PROVIDER=gemini  # Options: gemini, ollama, auto

# Google Gemini Configuration (if AI_PROVIDER=gemini or auto)
GEMINI_API_KEY=your-google-gemini-api-key
MODEL_ID=models/gemini-2.5-flash

# Ollama Configuration (if AI_PROVIDER=ollama or auto)
# Local Ollama instance for running DeepSeek-R1 or other models
OLLAMA_HOST=http://172.190.86.69:11434
OLLAMA_MODEL=deepseek-r1:latest

# -----------------------------------------------------------------------------
# CRITICAL: Databricks API Credentials (Required for error extraction)
# -----------------------------------------------------------------------------
# Without these, the system will only receive generic "job failed" messages
# from webhooks and cannot fetch detailed error information

# Your Databricks workspace URL (find in Azure Portal → Databricks → Overview → URL)
# Example: https://adb-1234567890123456.7.azuredatabricks.net
DATABRICKS_HOST=https://your-databricks-workspace-url.azuredatabricks.net

# Databricks Personal Access Token (generate in Databricks → User Settings → Access Tokens)
# How to generate:
#   1. Go to Databricks workspace
#   2. Click your profile (top right) → User Settings
#   3. Go to Access Tokens tab
#   4. Click "Generate New Token"
#   5. Give it a name like "RCA System" and lifetime (90-365 days)
#   6. Copy the token (it won't be shown again)
DATABRICKS_TOKEN=dapi1234567890abcdef...

# -----------------------------------------------------------------------------
# Optional: Slack Integration
# -----------------------------------------------------------------------------
SLACK_BOT_TOKEN=xoxb-your-slack-bot-token
SLACK_ALERT_CHANNEL=aiops-rca-alerts

# -----------------------------------------------------------------------------
# Optional: ITSM Integration (Jira)
# -----------------------------------------------------------------------------
ITSM_TOOL=jira  # Options: none, jira
JIRA_DOMAIN=https://your-company.atlassian.net
JIRA_USER_EMAIL=your-email@company.com
JIRA_API_TOKEN=your-jira-api-token
JIRA_PROJECT_KEY=AIOPS
JIRA_WEBHOOK_SECRET=your-webhook-secret

# -----------------------------------------------------------------------------
# Optional: Azure SQL Database (default: SQLite)
# -----------------------------------------------------------------------------
DB_TYPE=sqlite  # Options: sqlite, azuresql
DB_PATH=data/tickets.db  # Only used if DB_TYPE=sqlite

# Azure SQL configuration (only if DB_TYPE=azuresql)
# AZURE_SQL_SERVER=your-server.database.windows.net
# AZURE_SQL_DATABASE=rca_tickets
# AZURE_SQL_USERNAME=sqladmin
# AZURE_SQL_PASSWORD=your-password

# -----------------------------------------------------------------------------
# Optional: Azure Blob Storage (for audit logs)
# -----------------------------------------------------------------------------
AZURE_BLOB_ENABLED=false
AZURE_STORAGE_CONN=DefaultEndpointsProtocol=https;AccountName=...
AZURE_BLOB_CONTAINER_NAME=audit-logs

# -----------------------------------------------------------------------------
# Optional: Auto-Remediation
# -----------------------------------------------------------------------------
AUTO_REMEDIATION_ENABLED=false

# Azure Data Factory API Configuration (Required for monitoring pipeline re-runs)
# These credentials are used to monitor the status of remediation pipeline runs
AZURE_SUBSCRIPTION_ID=your-azure-subscription-id
AZURE_RESOURCE_GROUP=your-resource-group-name
AZURE_DATA_FACTORY_NAME=your-data-factory-name

# Azure Service Principal (for ADF API authentication)
# Option 1: Use Managed Identity (recommended for Azure App Service)
#   - No configuration needed, MSI_ENDPOINT and MSI_SECRET are auto-provided
# Option 2: Use Service Principal
AZURE_TENANT_ID=your-azure-tenant-id
AZURE_CLIENT_ID=your-service-principal-client-id
AZURE_CLIENT_SECRET=your-service-principal-client-secret

# Playbook URLs (Logic Apps or Azure Functions for auto-healing)
# These should be the HTTP trigger URLs from your Logic Apps
# Example: https://prod-12.northcentralus.logic.azure.com:443/workflows/.../triggers/manual/paths/invoke?api-version=...
PLAYBOOK_RERUN_UPSTREAM=https://your-logic-app-url-for-upstream-rerun
PLAYBOOK_RETRY_PIPELINE=https://your-logic-app-url-for-pipeline-retry
PLAYBOOK_RESTART_CLUSTER=https://your-logic-app-url-for-cluster-restart
PLAYBOOK_RETRY_JOB=https://your-logic-app-url-for-job-retry
PLAYBOOK_REINSTALL_LIBRARIES=https://your-logic-app-url-for-library-reinstall
PLAYBOOK_CHECK_PERMISSIONS=https://your-logic-app-url-for-permission-check

# -----------------------------------------------------------------------------
# Optional: Application Settings
# -----------------------------------------------------------------------------
PUBLIC_BASE_URL=http://localhost:8000